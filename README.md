Abstract:
Used a Convolutional Neural Network to detect clouds on Mauna Kea using Canada France Hawaii Telescope’s (CFHT) All Sky Infrared and Visible Analyzer (ASIVA). Two models were constructed: a full-sky image classifier, and a heatmap generator using different size pixel kernels. The full-sky classifier was able to determine clear skies with 100% accuracy (0% false positive rate) and cloudy skies with 96% accuracy (4% false negative rate). The heatmap
generator model used a convolutional neural network on a small kernel
which it passed over an input image to determine the likelihood of cloud
coverage at each location. Data cleaning was required to yield significant results due to dynamic range limitations of the sensor causing significant differences between clear and cloudy images. Different batch sizes were compared to test model convergence, ROC performance, and overall effectiveness. Smaller batch sizes were found to be more effective with a batch size of 32 yielding an AUC of 0.987. Cloud coverage percentage was determined by comparing each kernel’s prediction value against a determined threshold constant and dividing the number of kernels classified as cloudy by the total number of kernels. Overall, the heatmap model was found to provide significantly more data than the current system on cloud coverage over Mauna Kea. Cloud coverage percentage is a metric not currently available for continuous image acquisitions over Mauna Kea. Additionally, the heatmap approach provides data on cloud coverage in specific sky regions, allowing for much more accurate observations of cloud activity in regions of interest. Additional work is being done to incorporate data from CFHT’s SkyProbe instrument which yields an attenuation value for a specific sky location. SkyProbe attenuations were linked with telescope positional data and ASIVA images based on the times of measurement. Telescope positional data was used to identify SkyProbe altitude and azimuth. Reversing the distortion of the ASIVA’s Infrared sensor for a given pair of altitude and azimuth measurements yielded two sets of data corresponding to possible (x, y) pixel locations in an ASIVA image based on altitude and azimuth, respectively. Linear regression was used for the pixel locations of the azimuth value, and elliptical regression was used for the pixel locations of the altitude value. The intersection of these regression models was taken as the correct location of a SkyProbe attenuation value within its corresponding ASIVA image. Kernels were extracted from these images to build the dataset of kernels with corresponding attenuations as a measure of cloud intensity. Preliminary model results show a strong ability of this method to differentiate clear kernels from cloudy kernels. However, dataset limitations inhibit a strong correlation between predicted and actual attenuation values. Additional work is needed to tune the model architecture and find more data in ASIVA archives.



Non-Technical Abstract:
Atmospheric visibility is a major factor in the quality of data produced by ground-based instruments in astronomy. Two instruments Canada France Hawaii Telescope uses to address this issue are ASIVA and SkyProbe. ASIVA produces all-sky infrared and visible light images to identify clouds, and SkyProbe produces an attenuation measurement for the atmosphere in between the telescope and its observation target. A Convolutional Neural Network is used to detect clouds on Mauna Kea using ASIVA archival data. A full-sky model was able to determine clear skies with 100% accuracy and cloudy skies with 96% accuracy. A separate heatmap generator model used a small kernel passed over an input image to determine the likelihood of cloud coverage at each location, producing an AUC of 0.987. Further work is being done to incorporate SkyProbe data by correlating measurements to locations in ASIVA images. Preliminary results show a strong ability to differentiate clear from cloudy kernels. However, dataset limitations inhibit a strong correlation between predicted and actual attenuation values. Additional work is needed to tune the model architecture and find more data in ASIVA archives.


Source code at: 
https://github.com/ijustdontgitit/asiva_clouds
